library(devtools)
use_r('aaa.R')
use_r('zzz.R')
use_r('config.R')
use_r('http.R')
use_r('resolve.R')
use_r('properties.R')
use_r('map.R')
use_vignette('rxref_intro.Rmd')
use_mit_license("Steven Smith")
warnings()
load_all()
warnings()
load_all()
warnings()
use_mit_license(copyright_holder = "Steven Smith")
check()
check()
devtools::build_rmd("vignettes/rxref_intro.Rmd")
$stdout
.Last.error
devtools::build_rmd("vignettes/rxref_intro.Rmd")
devtools::build_rmd("vignettes/rxref_intro.Rmd")
devtools::document()
devtools::build_vignettes()
devtools::check()
devtools::document()
devtools::build_vignettes()
devtools::check()
devtools::document()
devtools::build_vignettes()
devtools::check()
load_all()
devtools::document()
devtools::build_vignettes()
devtools::check()
load_all()
document()
load_all()
devtools::document()
devtools::build_vignettes()
devtools::check()
devtools::document()     # <- IMPORTANT
devtools::build_vignettes()
devtools::check()
devtools::document()
build_vignettes()
check()
document()
document()
document()
document()
load_all()
document()
document()
build_vignettes()
check()
document()
build_vignettes()
check()
document()
build_vignettes()
check()
??rxref
??rxref
library(rxref)
library(dplyr)
# Be nice to the API while we experiment
rxref_conf(rate_delay = 0.15)  # ~6–7 req/sec with memoized cache
res_name <- resolve(c("metformin 500 mg tablet", "LIPITOR 20 MG"))
devtools::document()
library(rxref)
rxref_conf(rate_delay = 0.15)
# Name → RxCUI
res_name <- resolve(c("metformin 500 mg tablet", "LIPITOR 20 MG"))
res_name
res_ndc <- resolve(c("00093-1048-01","00093104801"))
res_ndc
res_cui <- resolve(c("860975","1049630"), type = "rxcui")
res_cui
get_properties(unique(na.omit(c(res_name$rxcui[1], res_ndc$rxcui[1]))))
map_ndc_to_rxcui(c("00093-1048-01","00093104801"))
map_rxcui_to_ndc("860975", status = "ACTIVE")
devtools::document()
library(rxref)
rxref_conf(rate_delay = 0.15)
# Name → RxCUI
res_name <- resolve(c("metformin 500 mg tablet", "LIPITOR 20 MG"))
res_name
res_ndc <- resolve(c("00093-1048-01","00093104801"))
res_ndc
res_cui <- resolve(c("860975","1049630"), type = "rxcui")
res_cui
get_properties(unique(na.omit(c(res_name$rxcui[1], res_ndc$rxcui[1]))))
map_ndc_to_rxcui(c("00093-1048-01","00093104801"))
all_ndcs <- map_rxcui_to_ndc("860975")
head(all_ndcs)
act_ndcs <- map_rxcui_to_ndc("860975", status = "ACTIVE")
head(act_ndcs)
map_rxcui_to_ndc("860975")
map_rxcui_to_ndc("860975", status = c("ACTIVE","OBSOLETE"))
devtools::document()
document()
library(rxref)
rxref_conf(rate_delay = 0.15)
# Sanity: name & ndc resolution
res_name <- resolve(c("metformin 500 mg tablet", "LIPITOR 20 MG"))
res_ndc  <- resolve(c("00093-1048-01","00093104801"))
View(res_name)
View(res_ndc)
get_properties(unique(na.omit(c(res_name$rxcui[1], res_ndc$rxcui[1]))))
m_all <- map_rxcui_to_ndc("860975")                # unfiltered
head(m_all)
m_act <- map_rxcui_to_ndc("860975", status = "ACTIVE")
head(m_act)
head_ndcs <- head(m_all$ndc11, 10)
data.frame(
ndc11 = head_ndcs,
status = sapply(head_ndcs, function(n) {
st <- try(rx_get_json("/ndcstatus", query = list(ndc = hyphenate_ndc_5_4_2(n))), silent = TRUE)
if (inherits(st, "try-error") || is.null(st$ndcStatus$status)) NA_character_ else st$ndcStatus$status
}),
stringsAsFactors = FALSE
)
