---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# rxref

<!-- badges: start -->
<!-- badges: end -->

**rxref** is an R package that includes a set of tidy utilities for querying the [National Library of Medicine](https://www.nlm.nih.gov/)'s [RxNorm](https://www.nlm.nih.gov/research/umls/rxnorm/index.html) API. RxNorm is a system of normalized names for clinical drugs as well as linkages from these names to many of the drug vocabularies commonly used in pharmacy management and drug interaction software, including those of First Databank, Micromedex, Multum, and Gold Standard Drug Database. 

**rxref** was originally built to facilitate pharmacoepidemiologic research in the [UF CVmedLab](https://cvmedlab.org/), where we often need to identify medication prescriptions or pharmacy dispensings as a proxy for medication exposure or outcomes. 

The core use case for **rxref** is identifying a set of RxCUIs (Rx Concept Unique Identifiers) and/or NDCs (national drug codes) that relate to a single medication or set of medications (i.e., a class of medications) supplied by the user. Additional functionality (still in early stage development) will include extracting additional properties (e.g., strength, dosage form, indications, adverse events, and so on) related to a user-supplied list of RxCUIs.

## Installation

You can install the development version of rxref from [GitHub](https://github.com/) with:

``` r
# install.packages("remotes")
remotes::install_github("ssmithm/rxref")
```

## Example

This is a basic example for querying RxCUIs associated with lisinopril (a blood pressure-lowering drug):

```{r ex1}
library(rxref)
lisinopril.ing <- find_ingredients('lisinopril')
lisinopril.ing |> knitr::kable()

lisinopril.rxcuis <- products_for_ingredients(lisinopril.ing$rxcui, ttys = c("SCD", "SBD"), include_combos = TRUE)

# Resulting table of all related products with TTY in {SCD, SBD}
lisinopril.rxcuis |> 
  dplyr::mutate(name = paste0("`", name, "`")) |> 
  knitr::kable()

# Count of TTYs in resulting table
aggregate(
  x = list(count = rep(1, nrow(lisinopril.rxcuis))), 
  by = list(tty = lisinopril.rxcuis$tty), 
  FUN = sum
) |> knitr::kable()
```
